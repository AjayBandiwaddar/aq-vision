<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-t" />
  <title>AQ-Vision — AI-Enhanced Air Quality</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">

  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

  <style>
    /* Base styles and custom components */
    body { font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }
    .smooth-scroll { scroll-behavior: smooth; }
    #map { width: 100%; height: 65vh; border-radius: 0.75rem; border: 1px solid #e2e8f0; }

    /* Custom spinner animation */
    .spinner {
      border: 4px solid rgba(0,0,0,0.1);
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border-left-color: #0284c7; /* Sky 600 */
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Chart container for responsiveness */
    .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 350px; }

    /* Custom input styles for a cleaner look */
    .input-label { font-size: 0.875rem; font-weight: 500; color: #475569; }
    .custom-input, .custom-select {
        margin-top: 0.25rem;
        width: 100%;
        padding: 0.6rem 0.75rem;
        border: 1px solid #cbd5e1;
        border-radius: 0.5rem;
        transition: border-color 0.2s, box-shadow 0.2s;
    }
    .custom-input:focus, .custom-select:focus {
        outline: none;
        border-color: #38bdf8;
        box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.4);
    }

    /* Styling for the small standard comparison cards */
    .std-card {
        background: #fff;
        padding: 1rem;
        border-radius: 0.75rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
        border: 1px solid #f1f5f9;
        width: 230px;
        margin-right: 12px;
        display: inline-block;
        vertical-align: top;
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-800 smooth-scroll">
  <header class="bg-white/90 backdrop-blur-lg shadow-sm sticky top-0 z-50 border-b border-slate-200">
    <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center">
          <span class="text-2xl font-bold text-sky-600">AQ Vision</span>
        </div>
        <div class="hidden md:block">
          <div class="ml-10 flex items-baseline space-x-2">
            <a href="#map-section" class="text-slate-600 hover:bg-slate-100 px-3 py-2 rounded-md text-sm font-medium transition-colors">Interactive Map</a>
            <a href="#analysis-section" class="text-slate-600 hover:bg-slate-100 px-3 py-2 rounded-md text-sm font-medium transition-colors">Data Analysis</a>
            <a href="#insights-section" class="text-slate-600 hover:bg-slate-100 px-3 py-2 rounded-md text-sm font-medium transition-colors">AI Insights</a>
            <a href="#about-section" class="text-slate-600 hover:bg-slate-100 px-3 py-2 rounded-md text-sm font-medium transition-colors">About</a>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <section id="map-section" class="mb-20">
      <div class="text-center mb-10">
        <h1 class="text-4xl font-extrabold tracking-tight text-slate-900 sm:text-5xl lg:text-6xl">AI-Driven Urban Air Quality Map</h1>
        <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600">High-resolution air quality estimates for your city. Click a zone or draw a polygon to get detailed insights.</p>
      </div>

      <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
        <div class="mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 items-end">
            <div>
              <label for="city-search" class="input-label">Search City</label>
              <div class="flex gap-2 mt-1">
                <input id="city-search" type="text" placeholder="e.g., Bangalore" class="custom-input flex-1" />
                <button id="city-search-btn" class="bg-sky-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-sky-700 transition-all transform hover:scale-105">Search</button>
              </div>
            </div>
            <div>
              <label for="lat-input" class="input-label">Latitude</label>
              <input id="lat-input" type="number" step="0.0001" placeholder="e.g., 12.9716" class="custom-input" />
            </div>
            <div>
              <label for="lon-input" class="input-label">Longitude</label>
              <input id="lon-input" type="number" step="0.0001" placeholder="e.g., 77.5946" class="custom-input" />
            </div>
            <div class="flex gap-2 justify-end">
                <button id="latlon-go" class="bg-emerald-600 text-white font-semibold px-4 py-2.5 rounded-lg hover:bg-emerald-700 transition-all transform hover:scale-105 w-full">Go</button>
                <button id="use-location" class="bg-slate-700 text-white font-semibold px-4 py-2.5 rounded-lg hover:bg-slate-800 transition-all transform hover:scale-105 w-full">My Location</button>
            </div>
        </div>

        <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="pollutant-select" class="input-label">Select Pollutant</label>
                <select id="pollutant-select" class="custom-select">
                  <option value="aqi" selected>Overall AQI</option>
                  <option value="pm25">PM2.5 (Particulate Matter < 2.5µm)</option>
                  <option value="no2">NO₂ (Nitrogen Dioxide)</option>
                  <option value="o3">O₃ (Ozone)</option>
                </select>
            </div>
            <div>
                <label for="date-slider" class="input-label">Date: <span id="date-label" class="font-bold text-sky-600"></span></label>
                <input id="date-slider" type="range" min="1" max="7" value="7" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer mt-3">
            </div>
        </div>

        <div id="pollutant-description" class="p-4 bg-sky-50 text-sky-800 rounded-lg text-sm mb-6 border border-sky-200">Select a pollutant to learn more about it.</div>

        <div class="relative">
            <div id="map"></div>
            <button id="toggle-live" class="absolute top-4 right-4 bg-indigo-600 text-white font-semibold px-4 py-2 rounded-lg shadow-md hover:bg-indigo-700 transition-all transform hover:scale-105">Use Live OpenAQ Data</button>
        </div>

        <div id="selected-area-details" class="hidden mt-6 bg-sky-50 p-6 rounded-xl border border-sky-200">
          <h3 class="text-xl font-bold text-sky-800 mb-3">Selected Area Report</h3>
          <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-sky-700">
            <p><strong>Average AQI:</strong> <span id="avg-aqi" class="font-semibold text-2xl ml-2"></span></p>
            <p><strong>Highest AQI:</strong> <span id="max-aqi" class="font-semibold text-2xl ml-2"></span></p>
            <p class="sm:col-span-2"><strong>Zones Included:</strong> <span id="zones-list"></span></p>
          </div>
          <button id="clear-area-button" class="mt-4 bg-rose-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-rose-700 transition-all transform hover:scale-105">Clear Selection</button>
        </div>

        <div id="multi-std" class="mt-6 overflow-x-auto whitespace-nowrap pb-4"></div>
      </div>
    </section>

    <section id="analysis-section" class="mb-20">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Project Analysis & Validation</h2>
        <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">Visual comparisons between our model's predictions and established ground sensor data.</p>
      </div>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
          <h3 class="text-xl font-semibold mb-4 text-center text-slate-800">Model Prediction vs. Ground Truth</h3>
          <div class="chart-container"><canvas id="validationChart"></canvas></div>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
          <h3 class="text-xl font-semibold mb-4 text-center text-slate-800">Average AQI by City Zone</h3>
          <div class="chart-container"><canvas id="zoneChart"></canvas></div>
        </div>
      </div>
    </section>

    <section id="insights-section" class="mb-20">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">AI-Powered Insights</h2>
        <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">Get instant, actionable analysis and recommendations based on the current map data.</p>
      </div>
      <div class="bg-white p-6 rounded-2xl shadow-lg border border-slate-200">
        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
          <button id="summarize-and-source-button" class="bg-sky-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-sky-700 transition-all transform hover:scale-105">Summary</button>
          <button id="health-recommendation-button" class="bg-amber-500 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-amber-600 transition-all transform hover:scale-105">Health</button>
          <button id="action-plan-button" class="bg-emerald-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-emerald-700 transition-all transform hover:scale-105">Action Plan</button>
          <button id="cigarette-button" class="bg-indigo-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-all transform hover:scale-105">Cigarette Eq.</button>
          <button id="school-button" class="bg-rose-600 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-rose-700 transition-all transform hover:scale-105">School</button>
          <button id="mask-button" class="bg-gray-700 text-white font-semibold py-2.5 px-4 rounded-lg shadow-md hover:bg-gray-800 transition-all transform hover:scale-105">Mask/Activity</button>
        </div>

        <div id="insights-output" class="p-6 bg-slate-100 text-slate-700 rounded-xl min-h-[150px] flex items-center justify-center">
          <p class="text-slate-500">Click a button above to generate AI insights.</p>
        </div>

        <div class="mt-6 flex flex-col sm:flex-row gap-4 items-center">
          <button id="generate-report-button" class="bg-violet-600 text-white font-semibold px-5 py-2.5 rounded-lg hover:bg-violet-700 transition-all transform hover:scale-105 w-full sm:w-auto">Download PDF Report</button>
          <small class="text-sm text-slate-500 text-center sm:text-left">Generates a 1-page PDF comparing the last month of PM2.5 data against WHO guidelines.</small>
        </div>
      </div>
    </section>

    <section id="about-section">
        <div class="bg-white p-8 sm:p-10 rounded-2xl shadow-lg border border-slate-200" style="background-color: #edd3bb;">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-slate-900 text-center mb-4">About This Project</h2>
                <p class="text-center text-lg text-slate-600 max-w-3xl mx-auto">
This application demonstrates a powerful approach to environmental monitoring. By leveraging multiple real-time data APIs and artificial intelligence, we can produce granular, actionable insights into urban air quality anywhere in the world.
                </p>

                <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8">
                    <div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">Methodology</h3>
                        <p class="text-slate-600">
The system fetches data from OpenAQ (global), AirNow (US), and OpenWeather for the user's selected coordinates. This data is visualized on the map and used to generate standard air quality index cards. The aggregated data is then passed to a large language model via a secure backend to generate qualitative insights and recommendations.
                        </p>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">Data Sources</h3>
                        <p class="text-slate-600">
                            <strong>Data Sources:</strong>Air Quality: Real-time sensor data from the OpenAQ Platform and AirNow.

                        </p>
                        <p class="text-slate-600 mt-2">
                             <strong>Weather:</strong> Current meteorological data from OpenWeather.
                        </p>
                    </div>
                </div>
                 <p class="text-center text-sm text-slate-500 mt-10">
                    This project is a proof-of-concept developed for a hackathon, showcasing the potential of combining public data with modern ML techniques.
                </p>
            </div>
        </div>
    </section>
  </main>

  <footer class="bg-slate-100 border-t border-slate-200 mt-20">
    <div class="container mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-sm text-slate-500">
      <p>&copy; 2025 AQ-Vision. For demonstration purposes only. Data and recommendations are illustrative.</p>
    </div>
  </footer>

  <script src="script.js" defer></script>
</body>
</html>